<div class="app-shell" [class.sidebar-open]="sidebarOpen">
  <aside class="sidebar" [class.open]="sidebarOpen">
    <div class="sidebar-header">
      <i class="pi pi-th-large logo" aria-hidden="true"></i>
      <span class="brand">Ecolink-MMS</span>
      <button class="close-btn" (click)="toggleSidebar()" aria-label="Close sidebar">
        <i class="pi pi-times" aria-hidden="true"></i>
      </button>
    </div>
    <nav class="menu" #menuNav>
      <a class="menu-item" *ngIf="allow('/dashboard')" routerLink="/dashboard" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
        <i class="pi pi-home" aria-hidden="true"></i>
        <span>Dashboard</span>
      </a>

      <a class="menu-item" *ngIf="allow('/applications')" routerLink="/applications" routerLinkActive="active">
        <i class="pi pi-briefcase" aria-hidden="true"></i>
        <span>Applications</span>
      </a>

      <a class="menu-item" *ngIf="allow('/sender-id')" routerLink="/sender-id" routerLinkActive="active">
        <i class="pi pi-id-card" aria-hidden="true"></i>
        <span>Sender IDs</span>
      </a>
      <a class="menu-item" *ngIf="allow('/add-funds')" routerLink="/add-funds" routerLinkActive="active">
        <i class="pi pi-wallet" aria-hidden="true"></i>
        <span>Add Funds</span>
      </a>

<!--      <a class="menu-item" routerLink="/providers" routerLinkActive="active">-->
<!--        <i class="pi pi-users" aria-hidden="true"></i>-->
<!--        <span>Providers</span>-->
<!--      </a>-->



      <a class="menu-item" *ngIf="allow('/group-contacts')" routerLink="/group-contacts" routerLinkActive="active">
        <i class="pi pi-address-book" aria-hidden="true"></i>
        <span>Group Contacts</span>
      </a>
      <a class="menu-item" *ngIf="allow('/send-sms')" routerLink="/send-sms" routerLinkActive="active">
        <i class="pi pi-send" aria-hidden="true"></i>
        <span>Send SMS</span>
      </a>

      <a class="menu-item"  routerLink="/sms-templates" routerLinkActive="active">
        <i class="pi pi-inbox" aria-hidden="true"></i>
        <span>SMS Templates</span>
      </a>

      <a class="menu-item" *ngIf="allow('/sms-records')" routerLink="/sms-records" routerLinkActive="active">
        <i class="pi pi-inbox" aria-hidden="true"></i>
        <span>SMS Records</span>
      </a>



      <a class="menu-item" *ngIf="allow('/users')" routerLink="/users" routerLinkActive="active">
        <i class="pi pi-user" aria-hidden="true"></i>
        <span>Users</span>
      </a>

      <a class="menu-item" routerLink="/sms-channel-price" routerLinkActive="active">
        <i class="pi pi-user" aria-hidden="true"></i>
        <span>Price List</span>
      </a>

      <a class="menu-item" *ngIf="allow('/notification-settings')" routerLink="/notification-settings" routerLinkActive="active">
        <i class="pi pi-bell" aria-hidden="true"></i>
        <span>Notification Settings</span>
      </a>

    </nav>
  </aside>

  <div class="overlay" (click)="closeSidebar()" [class.show]="isMobile && sidebarOpen"></div>

  <header class="topbar">
    <button class="hamburger" (click)="toggleSidebar()" aria-label="Toggle sidebar">
      <i class="pi pi-bars" aria-hidden="true"></i>
    </button>
    <div class="topbar-brand-container">
      <div class="topbar-brand">
        <span class="brand"><span class="brand-eco">Ecolink</span> <span class="brand-mms">MMS</span></span>
      </div>
    </div>

    <div class="topbar-actions">
      <button class="theme-btn" (click)="toggleTheme()" [attr.aria-label]="'Switch to ' + (theme==='light' ? 'dark' : 'light') + ' theme'">
        <i class="pi" [ngClass]="theme==='light' ? 'pi-moon' : 'pi-sun'" aria-hidden="true"></i>
      </button>
      <div class="user" (click)="toggleUserMenu($event)" role="button" tabindex="0" aria-haspopup="true" [attr.aria-expanded]="showUserMenu">
        <img [src]="user.avatar" [alt]="user.memberName" />
<!--        <img src="https://i.pravatar.cc/40" alt="User avatar">-->
        <span class="name">{{user.name}}</span>
      </div>
      <div class="user-menu" *ngIf="showUserMenu" (click)="$event.stopPropagation()">
        <a class="user-menu-item" routerLink="/profile" routerLinkActive="active" (click)="showUserMenu=false">
          <i class="pi pi-user" aria-hidden="true"></i>
          <span>Profile</span>
        </a>
        <a class="user-menu-item" routerLink="/update-password" routerLinkActive="active" (click)="showUserMenu=false">
          <i class="pi pi-key" aria-hidden="true"></i>
          <span>Update Password</span>
        </a>
        <a class="user-menu-item" href="#" (click)="logout()" >
          <i class="pi  pi-sign-out" aria-hidden="true"></i>
          <span>Log Out</span>
        </a>

      </div>
    </div>
  </header>

  <main class="content">
    <div class="container">
      <router-outlet />
    </div>
  </main>
</div>
