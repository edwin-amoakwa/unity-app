<form [formGroup]="smsForm" (ngSubmit)="onSubmit()" class="p-fluid">
  <div class="container-fluid">


    <!-- SMS Type -->
    <div class="row mb-3">
      <div class="col-sm-3">
        <label for="senderId" class="col-form-label">
          Sender ID <span class="text-danger">*</span>
        </label>
      </div>
      <div class="col-sm-9">
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="smsType"
                formControlName="smsType" id="inlineRadio1" value="single">
            <label class="form-check-label" for="inlineRadio1">Single SMS</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="smsType"
                formControlName="smsType" id="inlineRadio2" value="bulk">
            <label class="form-check-label" for="inlineRadio2">Bulk SMS</label>
        </div>
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="smsType"
                formControlName="smsType" id="inlineRadio2" value="custom">
            <label class="form-check-label" for="inlineRadio2">Custom SMS</label>
        </div>
      </div>
    </div>

    <!-- Sender ID Dropdown -->
    <div class="row mb-3">
      <div class="col-sm-3">
        <label for="senderId" class="col-form-label">
          Sender ID <span class="text-danger">*</span>
        </label>
      </div>
      <div class="col-sm-9">
        <p-dropdown
          id="senderId"
          formControlName="senderId"
          [options]="senderIds"
          optionLabel="senderId"
          optionValue="senderId"
          [loading]="isLoading"
          [class.ng-invalid]="isFieldInvalid('senderId')">
        </p-dropdown>
        <small *ngIf="isFieldInvalid('senderId')" class="text-danger d-block">
          {{ getFieldError('senderId') }}
        </small>
      </div>
    </div>


    <!-- Phone Numbers -->
    <div class="row mb-3">
      <div class="col-sm-3">
        <label for="phoneNos" class="col-form-label">
          Phone Numbers <span class="text-danger">*</span>
        </label>
      </div>
      <div class="col-sm-9" *ngIf="smsForm?.value?.smsType === 'single'">
        <input
          id="phoneNos"
          type="text"
          pInputText
          formControlName="phoneNos"
          [class.ng-invalid]="isFieldInvalid('phoneNos')" />
        <small class="d-block text-muted mt-1">Enter phone numbers separated by commas</small>
        <small *ngIf="isFieldInvalid('phoneNos')" class="text-danger d-block">
          {{ getFieldError('phoneNos') }}
        </small>
      </div>
      <div class="col-sm-9" *ngIf="smsForm?.value?.smsType === 'bulk'">
        <div class="row">
          <div class="col-md-12 mb-2">
              <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="phoneNumberSource"
                      formControlName="phoneNumberSource" id="inlineRadio1" value="copyPaste">
                  <label class="form-check-label" for="inlineRadio1">Copy and Paste</label>
              </div>
              <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="phoneNumberSource"
                      formControlName="phoneNumberSource" id="inlineRadio2" value="uploadedFile">
                  <label class="form-check-label" for="inlineRadio2">Upload File</label>
              </div>
              <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="phoneNumberSource"
                      formControlName="phoneNumberSource" id="inlineRadio2" value="group">
                  <label class="form-check-label" for="inlineRadio2">Groups</label>
              </div>
          </div>
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-12" *ngIf="smsForm?.value?.phoneNumberSource === 'copyPaste'">
                <textarea
                    *ngIf="smsForm?.value?.phoneNumberSource === 'copyPaste'"
                    id="phoneNos"
                    pInputTextarea
                    formControlName="phoneNos"
                    rows="4"
                    [class.ng-invalid]="isFieldInvalid('phoneNos')">
                  </textarea>
                  <small class="d-block text-muted mt-1">Enter phone numbers separated by commas</small>
                  <small *ngIf="isFieldInvalid('phoneNos')" class="text-danger d-block">
                    {{ getFieldError('phoneNos') }}
                  </small>
              </div>
              <div class="col-md-12" *ngIf="smsForm?.value?.phoneNumberSource === 'uploadedFile'">
                <label for="myfile">Select a file:</label>
                <input type="file" id="phoneNoFile" name="phoneNoFile">
                <small *ngIf="isFieldInvalid('phoneNoFile')" class="text-danger d-block">
                    {{ getFieldError('phoneNoFile') }}
                  </small>
              </div>
              <!-- <div class="col-md-12"> -->
                <div class="col-sm-3" *ngIf="smsForm?.value?.phoneNumberSource === 'group'">
                  <label for="groupId" class="col-form-label">
                    Group <span class="text-danger">*</span>
                  </label>
                </div>
                <div class="col-sm-9" *ngIf="smsForm?.value?.phoneNumberSource === 'group'">
                  <p-dropdown
                    id="groupId"
                    formControlName="groupId"
                    [options]="groups"
                    optionLabel="groupId"
                    optionValue="groupId"
                    [loading]="isLoading"
                    [class.ng-invalid]="isFieldInvalid('groupId')">
                  </p-dropdown>
                  <small *ngIf="isFieldInvalid('groupId')" class="text-danger d-block">
                    {{ getFieldError('groupId') }}
                  </small>
                </div>
              <!-- </div> -->
            </div>


          </div>
        </div>
      </div>
    </div>


    <!-- Message Text -->
    <div class="row mb-3">
      <div class="col-sm-3">
        <label for="messageText" class="col-form-label">
          Message Text <span class="text-danger">*</span>
        </label>
      </div>
      <div class="col-sm-9">
        <textarea
          id="messageText"
          pInputTextarea
          formControlName="messageText"
          rows="4"
          [class.ng-invalid]="isFieldInvalid('messageText')">
        </textarea>
        <div class="d-flex justify-content-between mt-1">
          <small *ngIf="isFieldInvalid('messageText')" class="text-danger">
            {{ getFieldError('messageText') }}
          </small>
          <small class="text-muted">
            Characters: {{ smsForm.get('messageText')?.value?.length || 0 }}/1000
          </small>
        </div>
      </div>
    </div>




    <!-- SMS Nature -->
    <div class="row mb-3">
      <div class="col-sm-3">
        <label for="smsNature" class="col-form-label">
          SMS Nature <span class="text-danger">*</span>
        </label>
      </div>
      <div class="col-sm-9">
        <p-dropdown
          id="smsNature"
          formControlName="smsNature"
          [options]="smsNatures"
          optionLabel="itemName"
          optionValue="id"
          [class.ng-invalid]="isFieldInvalid('smsNature')">
        </p-dropdown>
        <small *ngIf="isFieldInvalid('smsNature')" class="text-danger d-block">
          {{ getFieldError('smsNature') }}
        </small>
      </div>
    </div>

  </div>

  <p-divider></p-divider>

  <!-- SMS Options -->
  <div class="row mb-3">
    <div class="col-sm-3">
      <label class="col-form-label">SMS Options</label>
    </div>
    <div class="col-sm-9">
      <div class="row">
        <div class="col-sm-3 mb-2">
          <div class="form-check">
            <p-checkbox
              formControlName="dispatched"
              inputId="dispatched"
              [binary]="true">
            </p-checkbox>
            <label for="dispatched" class="form-check-label ms-2">Dispatched</label>
          </div>
        </div>

        <div class="col-sm-3 mb-2">
          <div class="form-check">
            <p-checkbox
              formControlName="flashSms"
              inputId="flashSms"
              [binary]="true">
            </p-checkbox>
            <label for="flashSms" class="form-check-label ms-2">Flash SMS</label>
          </div>
        </div>

        <div class="col-sm-3 mb-2">
          <div class="form-check">
            <p-checkbox
              formControlName="scheduleSms"
              inputId="scheduleSms"
              [binary]="true">
            </p-checkbox>
            <label for="scheduleSms" class="form-check-label ms-2">Schedule SMS</label>
          </div>
        </div>

        <div class="col-sm-3 mb-2">
          <div class="form-check">
            <p-checkbox
              formControlName="templateSms"
              inputId="templateSms"
              [binary]="true">
            </p-checkbox>
            <label for="templateSms" class="form-check-label ms-2">Template SMS</label>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scheduled Time (Conditional) -->
  <div class="row mb-3" *ngIf="smsForm.get('scheduleSms')?.value">
    <div class="col-sm-3">
      <label for="scheduledTime" class="col-form-label">
        Scheduled Time <span class="text-danger">*</span>
      </label>
    </div>
    <div class="col-sm-9">
      <p-calendar
        id="scheduledTime"
        formControlName="scheduledTime"
        [showTime]="true"
        [showSeconds]="false"
        dateFormat="mm/dd/yy"
        [class.ng-invalid]="isFieldInvalid('scheduledTime')">
      </p-calendar>
      <small *ngIf="isFieldInvalid('scheduledTime')" class="text-danger d-block">
        {{ getFieldError('scheduledTime') }}
      </small>
    </div>
  </div>

  <p-divider></p-divider>

  <!-- Pages Count (Read-only, Auto-calculated) -->
  <div class="row mb-3">
    <div class="col-sm-3">
      <label for="pagesCount" class="col-form-label">
        Pages Count
      </label>
    </div>
    <div class="col-sm-9">
      <p-inputNumber
        id="pagesCount"
        [disabled]="true"
        [showButtons]="false">
      </p-inputNumber>
    </div>
  </div>

  <!-- Total Recipients -->
  <div class="row mb-3">
    <div class="col-sm-3">
      <label for="totalRecipient" class="col-form-label">
        Total Recipients
      </label>
    </div>
    <div class="col-sm-9">
      <p-inputNumber
        id="totalRecipient"
        [disabled]="true"
        [showButtons]="false">
      </p-inputNumber>
    </div>
  </div>




  <p-divider></p-divider>

  <!-- Form Actions -->
  <div class="d-flex justify-content-end gap-2">
    <p-button
      label="Cancel"
      icon="pi pi-times"
      severity="secondary"
      [text]="true"
      (onClick)="onCancel()">
    </p-button>
    <p-button
      label="Save SMS"
      icon="pi pi-check"
      type="submit"
      [loading]="isLoading">
    </p-button>
  </div>
</form>
